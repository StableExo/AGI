# Exploitation Strategy for CVE-2009-BITCOIN-ENTROPY

This document outlines a high-level strategy for exploiting the hypothesized vulnerability in the Bitcoin v0.1.5 client's key generation process. The strategy is designed to leverage the existing parallel key search framework, adapting it to our specific, entropy-focused attack vector.

## Guiding Principles

1.  **Preserve Parallelism:** The search for a specific private key is an embarrassingly parallel problem. The existing `key_search_manager.py` and `key_search_worker.py` architecture is well-suited for this and must be preserved to ensure the search is conducted efficiently.
2.  **Targeted, Not Brute-Force:** This is not a brute-force attack. The search space is narrowed dramatically by our hypothesis. The goal is to replicate a small, high-probability set of initial entropy states.
3.  **Adapt, Don't Rewrite:** The existing toolchain will be modified, not replaced. This minimizes development time and reduces the risk of introducing new errors.

## Proposed Modifications to the Toolchain

The core idea is to modify the worker script (`key_search_worker.py`) to generate keys based on a simulated, predictable entropy pool rather than a simple counter. The manager (`key_search_manager.py`) will be responsible for orchestrating the generation of this entropy and distributing the search space.

### 1. `entropy_replicator.py` (New Tool)

A new tool will be created to run *once* on the target Windows 7 VM at the beginning of a search session.
- **Function:** Executes the Windows API calls identified in the `openssl_0.9.8h_entropy_analysis.md` report (e.g., `CreateToolhelp32Snapshot`).
- **Output:** A single, large file containing the raw "entropy snapshot" of the system at that moment. This file, `entropy_snapshot.bin`, will serve as the baseline for a search session.

### 2. `key_search_manager.py` (Modification)

The manager will be modified to:
- **Load Baseline Entropy:** Read the `entropy_snapshot.bin` file into memory.
- **Define Work Chunks:** Instead of distributing simple integer ranges, the manager will distribute work chunks that consist of:
    - A range of counters (e.g., 0 to 1,000,000).
    - The baseline entropy snapshot.
- **Distribute Work:** Send these complex work chunks to the workers.

### 3. `key_search_worker.py` (Modification)

The worker script will be the most significantly modified component. It will be adapted to:
- **Receive Work Chunk:** Accept the counter range and baseline entropy from the manager.
- **Iterate and Perturb:** For each counter in its assigned range, the worker will:
    1.  Create a *copy* of the baseline entropy.
    2.  "Perturb" this copy in a deterministic way using the counter. For example, it could XOR the counter into the first few bytes of the entropy buffer, or replace a section of the buffer corresponding to a predictable value (like a timestamp) with a new value derived from the counter.
- **Generate Candidate Key:** Use this perturbed entropy buffer as the seed for the `cryptography` library to generate a candidate private key. This step replaces the old logic of simply converting the counter to a private key.
- **Derive and Check:** Derive the Bitcoin address and check it against the target address.
- **Report Success:** If a match is found, report the successful private key and the counter/perturbation that produced it back to the manager.

## Execution Flow

1.  **Setup:** An operator (or an automated script) starts the target Windows 7 VM from a clean snapshot.
2.  **Entropy Capture:** The `entropy_replicator.py` script is run on the VM, generating `entropy_snapshot.bin`. This file is transferred back to the machine running the key search manager.
3.  **Search Initiation:** The `key_search_manager.py` is started. It loads the `entropy_snapshot.bin` and begins distributing work to the pool of `key_search_worker.py` processes.
4.  **Parallel Search:** The workers execute the search in parallel, each exploring a different set of perturbations on the same baseline entropy.
5.  **Termination:** The search concludes when the key is found or the defined search space has been exhausted. If the key is not found, the process can be repeated from step 1 to capture a new baseline entropy snapshot.

This strategy provides a clear and efficient path to test our vulnerability hypothesis while retaining the performance benefits of the original parallel processing architecture.